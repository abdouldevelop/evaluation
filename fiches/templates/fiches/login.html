{% extends 'fiches/base.html' %}

{% block title %}Connexion{% endblock %}

{% block extra_css %}
<style>
    /* ========================================
       üé® VARIABLES CSS - CHARTE GRAPHIQUE
       ======================================== */
    :root {
        --primary: #4c6559;
        --primary-dark: #3a4f44;
        --primary-light: #7a9882;
        --secondary: #eea12e;
        --secondary-dark: #d89125;
        --secondary-light: #f5b858;
    }

    /* ========================================
       ‚ú® ANIMATIONS KEYFRAMES
       ======================================== */

    @keyframes fadeInUp {
        from {
            opacity: 0;
            transform: translateY(30px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    @keyframes slideInLeft {
        from {
            opacity: 0;
            transform: translateX(-30px);
        }
        to {
            opacity: 1;
            transform: translateX(0);
        }
    }

    @keyframes bounceIn {
        0% {
            opacity: 0;
            transform: scale(0.3);
        }
        50% {
            opacity: 1;
            transform: scale(1.05);
        }
        70% {
            transform: scale(0.9);
        }
        100% {
            transform: scale(1);
        }
    }

    @keyframes pulse {
        0%, 100% {
            opacity: 1;
        }
        50% {
            opacity: 0.8;
        }
    }

    @keyframes shimmer {
        0% {
            background-position: -1000px 0;
        }
        100% {
            background-position: 1000px 0;
        }
    }

    /* ========================================
       üé® COMPOSANTS ANIM√âS
       ======================================== */

    .animate-fadeInUp {
        animation: fadeInUp 0.8s ease-out;
    }

    .animate-slideInLeft {
        animation: slideInLeft 0.6s ease-out;
    }

    .animate-bounceIn {
        animation: bounceIn 0.8s ease-out;
    }

    .animate-pulse-slow {
        animation: pulse 3s ease-in-out infinite;
    }

    /* Card avec glassmorphism */
    .glass-card {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.3);
    }

    /* Gradient de fond anim√© */
    .bg-gradient-animated {
        background: linear-gradient(135deg, #f8faf9 0%, #ffffff 25%, #f0f5f2 50%, #ffffff 75%, #f8faf9 100%);
        background-size: 400% 400%;
        animation: gradientShift 15s ease infinite;
    }

    @keyframes gradientShift {
        0% {
            background-position: 0% 50%;
        }
        50% {
            background-position: 100% 50%;
        }
        100% {
            background-position: 0% 50%;
        }
    }

    /* Effet de brillance sur le bouton */
    .btn-shimmer {
        position: relative;
        overflow: hidden;
    }

    .btn-shimmer::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(
            90deg,
            transparent,
            rgba(255, 255, 255, 0.3),
            transparent
        );
        transition: left 0.5s;
    }

    .btn-shimmer:hover::before {
        left: 100%;
    }

    /* Input focus effect */
    .input-focus-effect {
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        position: relative;
    }

    .input-focus-effect:focus {
        transform: translateY(-2px);
        box-shadow: 0 8px 16px rgba(76, 101, 89, 0.1);
    }

    /* Logo pulse effect */
    .logo-pulse {
        animation: logoPulse 2s ease-in-out infinite;
    }

    @keyframes logoPulse {
        0%, 100% {
            transform: scale(1);
            box-shadow: 0 0 0 0 rgba(238, 161, 46, 0.4);
        }
        50% {
            transform: scale(1.05);
            box-shadow: 0 0 0 10px rgba(238, 161, 46, 0);
        }
    }

    /* Badge decoratif anim√© */
    .decorative-badge {
        position: relative;
    }

    .decorative-badge::before,
    .decorative-badge::after {
        content: '';
        position: absolute;
        width: 100%;
        height: 100%;
        border-radius: 50%;
        border: 2px solid var(--secondary);
        opacity: 0;
        animation: ripple 2s cubic-bezier(0, 0.2, 0.8, 1) infinite;
    }

    .decorative-badge::after {
        animation-delay: 1s;
    }

    @keyframes ripple {
        0% {
            transform: scale(1);
            opacity: 1;
        }
        100% {
            transform: scale(1.5);
            opacity: 0;
        }
    }

    /* Effet d'erreur shake */
    @keyframes shake {
        0%, 100% {
            transform: translateX(0);
        }
        10%, 30%, 50%, 70%, 90% {
            transform: translateX(-5px);
        }
        20%, 40%, 60%, 80% {
            transform: translateX(5px);
        }
    }

    .error-shake {
        animation: shake 0.5s;
    }

    /* Transition smooth */
    .transition-smooth {
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    /* Hover sur le formulaire */
    .form-card-hover {
        transition: all 0.3s ease;
    }

    .form-card-hover:hover {
        transform: translateY(-5px);
        box-shadow: 0 20px 40px rgba(76, 101, 89, 0.2);
    }
</style>
{% endblock %}

{% block content %}
<!-- Container principal avec gradient anim√© -->
<div class="flex items-center justify-center min-h-[calc(100vh-10rem)] bg-gradient-animated py-12 px-4">
    <div class="w-full max-w-md animate-fadeInUp">
        <!-- Card principale avec glassmorphism -->
        <div class="glass-card rounded-2xl shadow-2xl overflow-hidden form-card-hover">
            <!-- En-t√™te institutionnel avec gradient -->
            <div class="bg-gradient-to-r from-[#4c6559] to-[#3a4f44] p-8 text-center border-b-4 border-[#eea12e] relative overflow-hidden">
                <!-- Effet de brillance en arri√®re-plan -->
                <div class="absolute inset-0 bg-gradient-to-r from-transparent via-white/10 to-transparent animate-pulse-slow"></div>
                
                <div class="relative z-10">
                    <h2 class="text-2xl md:text-3xl font-bold text-white mb-2 animate-slideInLeft">
                        Plateforme d'√âvaluation du Personnel de l'ANStat
                    </h2>
                    <div class="flex items-center justify-center space-x-2 text-sm text-gray-100 mt-3">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path>
                        </svg>
                        <span>Acc√®s S√©curis√©</span>
                    </div>
                </div>
            </div>
            
            <!-- Logo institutionnel avec effet pulse -->
            <div class="flex justify-center -mt-10 relative z-20 animate-bounceIn">
                <div class="decorative-badge h-20 w-20 rounded-full bg-white flex items-center justify-center border-4 border-[#eea12e] logo-pulse">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 text-[#4c6559]" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
                    </svg>
                </div>
            </div>
            
            <!-- Formulaire de connexion -->
            <div class="p-8 pt-6 space-y-6">
                <!-- Titre du formulaire -->
                <div class="text-center">
                    <h3 class="text-xl font-semibold text-gray-800 flex items-center justify-center space-x-2">
                        <svg class="w-5 h-5 text-[#eea12e]" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                        </svg>
                        <span>Authentification Utilisateur</span>
                    </h3>
                    <div class="h-1 w-20 bg-gradient-to-r from-[#4c6559] to-[#eea12e] rounded-full mx-auto mt-3"></div>
                </div>

                <!-- Messages d'erreur -->
                {% if form.errors or form.non_field_errors %}
                <div class="bg-red-50 border-l-4 border-red-500 p-4 rounded-lg error-shake">
                    <div class="flex items-start">
                        <svg class="w-5 h-5 text-red-500 mr-2 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                        <div>
                            <p class="text-sm font-medium text-red-800">Erreur d'authentification</p>
                            <p class="text-sm text-red-700 mt-1">Veuillez v√©rifier vos identifiants et r√©essayer.</p>
                        </div>
                    </div>
                </div>
                {% endif %}
                
                <!-- Formulaire -->
                <form method="post" class="space-y-5">
                    {% csrf_token %}
                    
                    <!-- Champ Matricule -->
                    <div class="space-y-2">
                        <label for="id_username" class="block text-sm font-semibold text-gray-700 flex items-center space-x-2">
                            <svg class="w-4 h-4 text-[#4c6559]" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V8a2 2 0 00-2-2h-5m-4 0V5a2 2 0 114 0v1m-4 0a2 2 0 104 0m-5 8a2 2 0 100-4 2 2 0 000 4zm0 0c1.306 0 2.417.835 2.83 2M9 14a3.001 3.001 0 00-2.83 2M15 11h3m-3 4h2"></path>
                            </svg>
                            <span>Matricule</span>
                        </label>
                        <div class="relative">
                            {{ form.username }}
                            <div class="absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none">
                                <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                                </svg>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Champ Mot de Passe -->
                    <div class="space-y-2">
                        <label for="id_password" class="block text-sm font-semibold text-gray-700 flex items-center space-x-2">
                            <svg class="w-4 h-4 text-[#4c6559]" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"></path>
                            </svg>
                            <span>Mot de Passe</span>
                        </label>
                        <div class="relative">
                            {{ form.password }}
                            <div class="absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none">
                                <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path>
                                </svg>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Bouton de connexion -->
                    <div class="space-y-4 pt-2">
                        <button type="submit" class="btn-shimmer w-full flex justify-center items-center py-3.5 px-6 border border-transparent rounded-xl shadow-lg text-base font-semibold text-white bg-gradient-to-r from-[#4c6559] to-[#3a4f44] hover:from-[#3a4f44] hover:to-[#4c6559] focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#eea12e] transition-smooth transform hover:scale-[1.02] hover:shadow-xl">
                            <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1"></path>
                            </svg>
                            <span>Se Connecter au Syst√®me</span>
                        </button>
                        
                        <!-- Note de s√©curit√© -->
                        <div class="flex items-center justify-center space-x-2 text-xs text-gray-500">
                            <svg class="w-4 h-4 text-[#eea12e]" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                            <span>Acc√®s r√©serv√© au personnel autoris√©</span>
                        </div>
                    </div>
                </form>
            </div>

            <!-- Footer d√©coratif -->
            <div class="bg-gradient-to-r from-gray-50 to-gray-100 px-8 py-4 border-t border-gray-200">
                <div class="flex items-center justify-center space-x-6 text-xs text-gray-600">
                    <div class="flex items-center space-x-1">
                        <svg class="w-4 h-4 text-[#4c6559]" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"></path>
                        </svg>
                        <span>Connexion S√©curis√©e</span>
                    </div>
                    <div class="h-4 w-px bg-gray-300"></div>
                    <div class="flex items-center space-x-1">
                        <svg class="w-4 h-4 text-[#eea12e]" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path>
                        </svg>
                        <span>Donn√©es Crypt√©es</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Texte d'aide en dessous -->
        <div class="mt-6 text-center text-sm text-gray-600 animate-fadeInUp" style="animation-delay: 0.3s; opacity: 0; animation-fill-mode: forwards;">
            <p class="flex items-center justify-center space-x-2">
                <svg class="w-4 h-4 text-[#eea12e]" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
                <span>En cas de probl√®me, contactez votre administrateur syst√®me</span>
            </p>
        </div>
    </div>
</div>

<!-- Script pour styliser les champs de formulaire Django -->
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Ajouter des classes Tailwind aux champs g√©n√©r√©s par Django
        const inputs = document.querySelectorAll('input[type="text"], input[type="password"]');
        inputs.forEach(input => {
            input.classList.add(
                'input-focus-effect',
                'appearance-none', 
                'block', 
                'w-full', 
                'px-4', 
                'py-3', 
                'pr-10',
                'border-2', 
                'border-gray-200', 
                'rounded-xl', 
                'shadow-sm',
                'text-gray-800',
                'placeholder-gray-400', 
                'focus:outline-none', 
                'focus:ring-2', 
                'focus:ring-[#eea12e]', 
                'focus:border-[#eea12e]',
                'transition-smooth'
            );

            // Ajouter un placeholder si non existant
            if (!input.placeholder) {
                if (input.type === 'text') {
                    input.placeholder = 'Entrez votre matricule';
                } else if (input.type === 'password') {
                    input.placeholder = 'Entrez votre mot de passe';
                }
            }
        });

        // Animation au focus des inputs
        inputs.forEach(input => {
            input.addEventListener('focus', function() {
                this.parentElement.classList.add('scale-[1.01]');
            });
            
            input.addEventListener('blur', function() {
                this.parentElement.classList.remove('scale-[1.01]');
            });
        });

        // Animation du bouton submit au hover
        const submitBtn = document.querySelector('button[type="submit"]');
        if (submitBtn) {
            submitBtn.addEventListener('mouseenter', function() {
                this.classList.add('shadow-2xl');
            });
            
            submitBtn.addEventListener('mouseleave', function() {
                this.classList.remove('shadow-2xl');
            });
        }

        // Animation de validation du formulaire
        const form = document.querySelector('form');
        if (form) {
            form.addEventListener('submit', function() {
                submitBtn.innerHTML = `
                    <svg class="animate-spin h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24">
                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                    </svg>
                    <span>Connexion en cours...</span>
                `;
                submitBtn.disabled = true;
            });
        }
    });
</script>
{% endblock %}
